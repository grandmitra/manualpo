<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Aplikasi Purchase Order Management</title>
    <style>
        :root {
            --primary: #4361ee;
            --secondary: #3a0ca3;
            --success: #4cc9f0;
            --danger: #f72585;
            --warning: #f8961e;
            --light: #f8f9fa;
            --dark: #212529;
            --gray: #6c757d;
            --sidebar-width: 250px;
        }
        
        * {
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 0;
        }
        
        body {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            position: relative;
            overflow-x: hidden;
        }
        
        .app-wrapper {
            display: flex;
            min-height: 100vh;
            width: 100%;
            overflow-x: hidden;
        }
        
        .sidebar-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            z-index: 99;
        }
        
        .sidebar-overlay.active {
            display: block;
        }
        
        .sidebar {
            width: var(--sidebar-width);
            background: linear-gradient(180deg, var(--primary) 0%, var(--secondary) 100%);
            color: white;
            padding: 20px 0;
            height: 100vh;
            position: fixed;
            left: 0;
            top: 0;
            box-shadow: 5px 0 15px rgba(0,0,0,0.2);
            z-index: 100;
            transition: transform 0.3s ease;
        }
        
        .sidebar.active {
            transform: translateX(0);
        }
        
        .logo {
            text-align: center;
            padding: 20px;
            border-bottom: 1px solid rgba(255,255,255,0.1);
            margin-bottom: 30px;
        }
        
        .logo h1 {
            font-size: 1.5rem;
            margin-bottom: 5px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }
        
        .logo span {
            font-size: 0.8rem;
            opacity: 0.8;
            display: block;
            margin-top: 5px;
        }
        
        .nav-menu {
            list-style: none;
            padding: 0 15px;
        }
        
        .nav-item {
            margin-bottom: 10px;
        }
        
        .nav-link {
            display: flex;
            align-items: center;
            gap: 15px;
            padding: 15px;
            color: white;
            text-decoration: none;
            border-radius: 10px;
            transition: all 0.3s;
            font-weight: 500;
        }
        
        .nav-link:hover, .nav-link.active {
            background: rgba(255,255,255,0.15);
            transform: translateX(5px);
        }
        
        .nav-link i {
            font-size: 1.2rem;
            width: 24px;
            text-align: center;
        }
        
        .main-content {
            flex: 1;
            margin-left: var(--sidebar-width);
            padding: 20px;
            min-height: 100vh;
            transition: margin-left 0.3s ease;
            width: 100%;
            overflow-x: hidden;
        }
        
        .page-container {
            width: 100%;
            max-width: 100%;
            overflow-x: hidden;
        }
        
        .page {
            display: none;
            animation: fadeIn 0.3s ease;
            width: 100%;
            max-width: 100%;
            overflow-x: hidden;
        }
        
        .page.active {
            display: block;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .mobile-menu-btn {
            display: none;
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 101;
            background: var(--primary);
            color: white;
            border: none;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            font-size: 1.5rem;
            cursor: pointer;
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
            transition: all 0.3s ease;
        }
        
        .mobile-menu-btn:hover {
            background: var(--secondary);
            transform: scale(1.05);
        }
        
        .mobile-menu-btn.active {
            transform: rotate(90deg);
        }
        
        .mobile-header {
            display: none;
            background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
            color: white;
            padding: 15px 20px;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            z-index: 98;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        .mobile-header h2 {
            font-size: 1.2rem;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        @media (max-width: 992px) {
            .sidebar {
                transform: translateX(-100%);
            }
            
            .sidebar.active {
                transform: translateX(0);
            }
            
            .main-content {
                margin-left: 0;
                padding: 20px;
                width: 100%;
            }
            
            .mobile-menu-btn {
                display: flex;
                align-items: center;
                justify-content: center;
            }
            
            .mobile-header {
                display: flex;
                align-items: center;
                justify-content: space-between;
            }
            
            .header {
                margin-top: 70px;
            }
            
            .page-container {
                padding-right: 0;
            }
        }
        
        @media (max-width: 768px) {
            body {
                padding: 0;
                overflow-x: hidden;
            }
            
            .app-wrapper {
                overflow-x: hidden;
            }
            
            .main-content {
                padding: 15px;
                width: 100%;
                overflow-x: hidden;
            }
            
            .header {
                padding: 20px;
                margin-top: 70px;
                margin-bottom: 20px;
                width: 100%;
                max-width: 100%;
                overflow-x: hidden;
            }
            
            .form-section {
                padding: 20px;
                width: 100%;
                max-width: 100%;
                overflow-x: hidden;
            }
            
            .dashboard-cards {
                grid-template-columns: 1fr;
                gap: 15px;
                width: 100%;
            }
            
            .mobile-menu-btn {
                top: 15px;
                right: 15px;
                width: 45px;
                height: 45px;
                font-size: 1.3rem;
            }
            
            .mobile-header {
                padding: 12px 15px;
            }
            
            .table-container {
                padding: 15px;
                margin-top: 10px;
                width: 100%;
                overflow-x: auto;
            }
            
            .actions {
                flex-direction: column;
                width: 100%;
            }
            
            .btn {
                width: 100%;
            }
            
            .items-table, .po-table {
                min-width: 100%;
                font-size: 0.9rem;
            }
            
            .form-group {
                min-width: 100%;
            }
        }
        
        @media (max-width: 480px) {
            .main-content {
                padding: 10px;
            }
            
            .header {
                padding: 15px;
                margin-top: 60px;
            }
            
            .form-section {
                padding: 15px;
            }
            
            .card {
                padding: 20px;
            }
            
            .mobile-menu-btn {
                top: 10px;
                right: 10px;
                width: 40px;
                height: 40px;
                font-size: 1.2rem;
            }
            
            .search-box {
                min-width: 100%;
            }
            
            .table-header {
                flex-direction: column;
                gap: 10px;
            }
            
            .btn-sm {
                padding: 8px 12px;
                font-size: 0.8rem;
            }
            
            .items-table th,
            .items-table td,
            .po-table th,
            .po-table td {
                padding: 8px 5px;
                font-size: 0.8rem;
            }
        }
        
        .header {
            background: white;
            padding: 25px;
            border-radius: 15px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
            margin-bottom: 30px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            width: 100%;
        }
        
        .header h2 {
            color: var(--dark);
            font-size: 1.8rem;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .header h2 i {
            color: var(--primary);
        }
        
        .dashboard-cards {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
            width: 100%;
        }
        
        .card {
            background: white;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.08);
            transition: transform 0.3s;
            width: 100%;
        }
        
        .card:hover {
            transform: translateY(-5px);
        }
        
        .card-icon {
            width: 60px;
            height: 60px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 20px;
            font-size: 1.5rem;
        }
        
        .card.total .card-icon { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; }
        .card.pending .card-icon { background: linear-gradient(135deg, #f8961e 0%, #f9c74f 100%); color: white; }
        .card.completed .card-icon { background: linear-gradient(135deg, #4cc9f0 0%, #4895ef 100%); color: white; }
        .card.amount .card-icon { background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%); color: white; }
        
        .card h3 {
            font-size: 1.8rem;
            margin-bottom: 5px;
            color: var(--dark);
        }
        
        .card p {
            color: var(--gray);
            font-size: 0.9rem;
        }
        
        .form-section {
            background: white;
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 20px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.05);
            width: 100%;
        }
        
        .form-section h3 {
            color: var(--dark);
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid var(--light);
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .form-row {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
            margin-bottom: 20px;
            width: 100%;
        }
        
        .form-group {
            flex: 1;
            min-width: 250px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--dark);
        }
        
        .form-group input, .form-group textarea, .form-group select {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid #e1e1e1;
            border-radius: 10px;
            font-size: 14px;
            transition: all 0.3s;
        }
        
        .form-group input:focus, .form-group textarea:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(67, 97, 238, 0.1);
        }
        
        .items-section {
            overflow-x: auto;
            margin: 20px 0;
            width: 100%;
        }
        
        .items-table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            min-width: 900px;
        }
        
        .items-table th {
            background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
            color: white;
            padding: 12px 10px;
            text-align: left;
            font-weight: 600;
            white-space: nowrap;
            font-size: 0.9rem;
        }
        
        .items-table td {
            padding: 10px;
            border-bottom: 1px solid #e1e1e1;
            background: white;
        }
        
        .items-table tr:hover td {
            background-color: #f8f9ff;
        }
        
        .items-table input {
            width: 100%;
            padding: 8px 10px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 14px;
        }
        
        .items-table input:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 2px rgba(67, 97, 238, 0.1);
        }
        
        .total-cell {
            font-weight: bold;
            font-family: 'Courier New', monospace;
            text-align: right;
        }
        
        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 600;
            transition: all 0.3s;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }
        
        .btn-primary {
            background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
            color: white;
        }
        
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(67, 97, 238, 0.3);
        }
        
        .btn-success {
            background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%);
            color: white;
        }
        
        .btn-danger {
            background: linear-gradient(135deg, #f72585 0%, #b5179e 100%);
            color: white;
        }
        
        .btn-warning {
            background: linear-gradient(135deg, #f8961e 0%, #f9c74f 100%);
            color: white;
        }
        
        .btn-sm {
            padding: 6px 12px;
            font-size: 12px;
        }
        
        .form-controls, .actions {
            display: flex;
            gap: 15px;
            margin-top: 20px;
            flex-wrap: wrap;
            width: 100%;
        }
        
        .table-container {
            background: white;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.05);
            margin-top: 20px;
            width: 100%;
        }
        
        .table-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            flex-wrap: wrap;
            gap: 15px;
            width: 100%;
        }
        
        .search-box {
            flex: 1;
            min-width: 200px;
            position: relative;
        }
        
        .search-box input {
            width: 100%;
            padding: 12px 15px 12px 45px;
            border: 2px solid #e1e1e1;
            border-radius: 10px;
            font-size: 14px;
        }
        
        .search-box i {
            position: absolute;
            left: 15px;
            top: 50%;
            transform: translateY(-50%);
            color: var(--gray);
        }
        
        .table-responsive {
            overflow-x: auto;
            width: 100%;
        }
        
        .po-table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            min-width: 700px;
        }
        
        .po-table th {
            background: #f8f9fa;
            padding: 15px;
            text-align: left;
            font-weight: 600;
            color: var(--dark);
            border-bottom: 2px solid #e1e1e1;
            white-space: nowrap;
        }
        
        .po-table td {
            padding: 15px;
            border-bottom: 1px solid #e1e1e1;
        }
        
        .po-table tr:hover {
            background-color: #f8f9ff;
        }
        
        .status-badge {
            padding: 5px 12px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 600;
            display: inline-block;
        }
        
        .status-draft { background: #e3f2fd; color: #1976d2; }
        .status-pending { background: #fff3e0; color: #f57c00; }
        .status-approved { background: #e8f5e9; color: #388e3c; }
        .status-rejected { background: #ffebee; color: #d32f2f; }
        
        .action-buttons {
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
        }
        
        .pagination {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 20px;
            flex-wrap: wrap;
            gap: 15px;
            width: 100%;
        }
        
        .pagination-controls {
            display: flex;
            gap: 10px;
            align-items: center;
        }
        
        .page-size-selector select {
            padding: 8px 15px;
            border: 2px solid #e1e1e1;
            border-radius: 10px;
            font-size: 14px;
        }
        
        .page-numbers {
            display: flex;
            gap: 5px;
            flex-wrap: wrap;
        }
        
        .page-btn {
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            border: 2px solid #e1e1e1;
            border-radius: 10px;
            background: white;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .page-btn:hover, .page-btn.active {
            background: var(--primary);
            color: white;
            border-color: var(--primary);
        }
        
        /* Modal Styles */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.8);
            z-index: 1000;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }
        
        .modal.active {
            display: flex;
        }
        
        .modal-content {
            background: white;
            border-radius: 15px;
            max-width: 900px;
            width: 100%;
            max-height: 95vh;
            overflow-y: auto;
            animation: modalSlideIn 0.3s ease;
        }
        
        @keyframes modalSlideIn {
            from { transform: translateY(-50px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }
        
        .modal-header {
            background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
            color: white;
            padding: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-radius: 15px 15px 0 0;
        }
        
        .modal-header h3 {
            margin: 0;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .close-btn {
            background: rgba(255,255,255,0.2);
            border: none;
            color: white;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            cursor: pointer;
            font-size: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s;
        }
        
        .close-btn:hover {
            background: rgba(255,255,255,0.3);
            transform: rotate(90deg);
        }
        
        /* Print Container - DIUBAH untuk print normal */
        .print-container {
            padding: 20px;
            font-family: Arial, sans-serif;
            font-size: 12px;
            color: #000;
            background: white !important;
        }
        
        /* Style khusus untuk print */
        @media print {
            body * {
                visibility: hidden;
                background: white !important;
                color: black !important;
            }
            
            #printSection, #printSection * {
                visibility: visible;
                background: white !important;
                color: black !important;
                box-shadow: none !important;
                text-shadow: none !important;
            }
            
            #printSection {
                position: absolute;
                left: 0;
                top: 0;
                width: 100%;
                padding: 20px;
                margin: 0;
                background: white !important;
            }
            
            .no-print {
                display: none !important;
            }
            
            /* Hapus semua background warna untuk hemat tinta */
            table, th, td {
                border: 1px solid #000 !important;
                background: white !important;
                color: black !important;
            }
            
            th {
                background-color: #f0f0f0 !important;
                font-weight: bold;
            }
            
            /* Hilangkan semua gradient dan warna */
            .modal-header, .btn, .card, .sidebar, .header, .form-section {
                background: white !important;
                color: black !important;
                box-shadow: none !important;
            }
        }
        
        /* Tabel untuk cetakan */
        .print-table {
            width: 100%;
            border-collapse: collapse;
            margin: 10px 0;
            font-size: 11px;
            background: white !important;
        }
        
        .print-table th {
            background-color: #f0f0f0 !important;
            border: 1px solid #000;
            padding: 6px;
            text-align: center;
            font-weight: bold;
            color: black !important;
        }
        
        .print-table td {
            border: 1px solid #000;
            padding: 6px;
            text-align: left;
            color: black !important;
        }
        
        .print-table .text-right {
            text-align: right;
        }
        
        .print-table .text-center {
            text-align: center;
        }
        
        /* Total table untuk cetakan */
        .total-table {
            width: 300px;
            border-collapse: collapse;
            margin-left: auto;
            margin-top: 10px;
            font-size: 11px;
            background: white !important;
        }
        
        .total-table td {
            padding: 4px 8px;
            border: 1px solid #000;
            color: black !important;
        }
        
        .total-table .total-label {
            font-weight: bold;
            background-color: #f0f0f0 !important;
        }
        
        .total-table .total-value {
            text-align: right;
            font-weight: bold;
            font-family: 'Courier New', monospace;
        }
        
        /* Signature section untuk cetakan */
        .signature-section {
            display: flex;
            justify-content: space-between;
            margin-top: 50px;
            text-align: center;
        }
        
        .signature-box {
            width: 200px;
        }
        
        .signature-line {
            border-top: 1px solid #000;
            margin-top: 60px;
            padding-top: 5px;
        }
        
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 15px 25px;
            background: var(--success);
            color: white;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
            transform: translateX(150%);
            transition: transform 0.3s;
            z-index: 1001;
        }
        
        .notification.show {
            transform: translateX(0);
        }
        
        .notification.error {
            background: var(--danger);
        }
        
        .notification.warning {
            background: var(--warning);
        }
        
        .currency-cell {
            text-align: right;
            font-family: 'Courier New', monospace;
        }
        
        .qty-unit {
            display: flex;
            gap: 5px;
        }
        
        .qty-unit input {
            width: 60%;
        }
        
        .qty-unit select {
            width: 40%;
            padding: 8px 5px;
            border: 1px solid #ddd;
            border-radius: 5px;
        }
        
        /* Hidden print section */
        #printSection {
            display: none;
        }
        
        @media print {
            #printSection {
                display: block;
            }
        }
    </style>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
</head>
<body>
    <button class="mobile-menu-btn" id="mobileMenuBtn">
        <i class="fas fa-bars"></i>
    </button>
    
    <div class="mobile-header" id="mobileHeader">
        <h2><i class="fas fa-file-invoice-dollar"></i> PO System</h2>
        <div class="date-info" id="mobileDate"></div>
    </div>
    
    <div class="sidebar-overlay" id="sidebarOverlay"></div>
    
    <div class="app-wrapper">
        <nav class="sidebar" id="sidebar">
            <div class="logo">
                <h1><i class="fas fa-file-invoice-dollar"></i> PO System</h1>
                <span>Purchase Order Management</span>
            </div>
            <ul class="nav-menu">
                <li class="nav-item">
                    <a href="#dashboard" class="nav-link active" data-page="dashboard">
                        <i class="fas fa-tachometer-alt"></i>
                        <span>Dashboard</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a href="#buat-po" class="nav-link" data-page="buat-po">
                        <i class="fas fa-plus-circle"></i>
                        <span>Buat PO Baru</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a href="#daftar-po" class="nav-link" data-page="daftar-po">
                        <i class="fas fa-list"></i>
                        <span>Daftar PO</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a href="#export" class="nav-link" data-page="export">
                        <i class="fas fa-file-export"></i>
                        <span>Export Data</span>
                    </a>
                </li>
            </ul>
        </nav>
        
        <main class="main-content">
            <div class="page-container">
                <!-- Dashboard Page -->
                <div class="page active" id="dashboard">
                    <div class="header">
                        <h2><i class="fas fa-tachometer-alt"></i> Dashboard</h2>
                        <div class="date-info">
                            <i class="fas fa-calendar"></i> <span id="currentDate"></span>
                        </div>
                    </div>
                    
                    <div class="dashboard-cards">
                        <div class="card total">
                            <div class="card-icon">
                                <i class="fas fa-file-invoice"></i>
                            </div>
                            <h3 id="totalPO">0</h3>
                            <p>Total Purchase Order</p>
                        </div>
                        <div class="card pending">
                            <div class="card-icon">
                                <i class="fas fa-clock"></i>
                            </div>
                            <h3 id="pendingPO">0</h3>
                            <p>PO Pending</p>
                        </div>
                        <div class="card completed">
                            <div class="card-icon">
                                <i class="fas fa-check-circle"></i>
                            </div>
                            <h3 id="approvedPO">0</h3>
                            <p>PO Disetujui</p>
                        </div>
                        <div class="card amount">
                            <div class="card-icon">
                                <i class="fas fa-money-bill-wave"></i>
                            </div>
                            <h3 class="currency" id="totalAmount">0</h3>
                            <p>Total Nilai PO</p>
                        </div>
                    </div>
                    
                    <div class="table-container">
                        <div class="table-header">
                            <h3><i class="fas fa-history"></i> PO Terbaru</h3>
                        </div>
                        <div class="table-responsive">
                            <table class="po-table" id="recentPOs">
                                <thead>
                                    <tr>
                                        <th>No PO</th>
                                        <th>Supplier</th>
                                        <th>Tanggal</th>
                                        <th>Total</th>
                                        <th>Status</th>
                                        <th>Aksi</th>
                                    </tr>
                                </thead>
                                <tbody>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
                
                <!-- Buat PO Page -->
                <div class="page" id="buat-po">
                    <div class="header">
                        <h2><i class="fas fa-plus-circle"></i> Buat Purchase Order Baru</h2>
                    </div>
                    
                    <div class="form-section">
                        <h3><i class="fas fa-building"></i> Informasi Perusahaan & PO</h3>
                        <div class="form-row">
                            <div class="form-group">
                                <label for="companyName">Nama Perusahaan</label>
                                <input type="text" id="companyName" value="PT. GRAND MITRA BANGUNAN">
                            </div>
                            <div class="form-group">
                                <label for="companyAddress">Alamat Perusahaan</label>
                                <textarea id="companyAddress">THAMRIN CENTRE AVENUE NO. 18, JALAN MH THAMRIN KEL. KOSAMBI BARUT, KEC. KOSAMBI TANGERANG - BANTEN, TELP 021-39727272</textarea>
                            </div>
                        </div>
                        
                        <div class="form-row">
                            <div class="form-group">
                                <label for="poNumber">Nomor PO <small>(Format: GM11.YYMMDD.XXX)</small></label>
                                <div style="display: flex; gap: 10px;">
                                    <input type="text" id="poNumber" style="flex: 1;">
                                    <button type="button" class="btn btn-sm btn-success" onclick="generatePONumber()">
                                        <i class="fas fa-sync-alt"></i> Auto Generate
                                    </button>
                                </div>
                            </div>
                            <div class="form-group">
                                <label for="poDate">Tanggal PO</label>
                                <input type="date" id="poDate">
                            </div>
                            <div class="form-group">
                                <label for="poStatus">Status PO</label>
                                <select id="poStatus">
                                    <option value="draft">Draft</option>
                                    <option value="pending">Pending</option>
                                    <option value="approved">Disetujui</option>
                                    <option value="rejected">Ditolak</option>
                                </select>
                            </div>
                        </div>
                    </div>
                    
                    <div class="form-section">
                        <h3><i class="fas fa-truck"></i> Informasi Supplier</h3>
                        <div class="form-row">
                            <div class="form-group">
                                <label for="supplierName">Nama Supplier</label>
                                <input type="text" id="supplierName" placeholder="Contoh: ANGELS WINGS">
                            </div>
                            <div class="form-group">
                                <label for="supplierAddress">Alamat Supplier</label>
                                <input type="text" id="supplierAddress" placeholder="Contoh: PIK2">
                            </div>
                            <div class="form-group">
                                <label for="supplierPhone">Telepon Supplier</label>
                                <input type="text" id="supplierPhone" placeholder="Contoh: 021-12345678">
                            </div>
                        </div>
                    </div>
                    
                    <div class="form-section">
                        <h3><i class="fas fa-boxes"></i> Daftar Barang</h3>
                        <div class="items-section">
                            <table class="items-table">
                                <thead>
                                    <tr>
                                        <th width="3%">NO</th>
                                        <th width="25%">NAMA BARANG</th>
                                        <th width="10%">QTY</th>
                                        <th width="8%">SATUAN</th>
                                        <th width="12%">HARGA SAT</th>
                                        <th width="8%">DISC %</th>
                                        <th width="12%">DISC TOTAL</th>
                                        <th width="12%">JUMLAH</th>
                                        <th width="5%">AKSI</th>
                                    </tr>
                                </thead>
                                <tbody id="itemsBody">
                                </tbody>
                            </table>
                        </div>
                        
                        <div class="form-controls">
                            <button type="button" class="btn btn-success" id="addItemBtn">
                                <i class="fas fa-plus-circle"></i> Tambah Barang
                            </button>
                            <button type="button" class="btn btn-warning" id="clearItemsBtn">
                                <i class="fas fa-trash-alt"></i> Hapus Semua
                            </button>
                        </div>
                    </div>
                    
                    <div class="form-section">
                        <h3><i class="fas fa-calculator"></i> Total & Pajak</h3>
                        <div class="form-row">
                            <div class="form-group" style="max-width: 400px; margin-left: auto;">
                                <div style="display: flex; justify-content: space-between; margin-bottom: 10px;">
                                    <span>Sub Total:</span>
                                    <span id="subTotalDisplay" class="currency">Rp 0</span>
                                </div>
                                <div style="display: flex; justify-content: space-between; margin-bottom: 10px;">
                                    <span>Total Diskon:</span>
                                    <span id="totalDiscountDisplay" class="currency">Rp 0</span>
                                </div>
                                <div style="display: flex; justify-content: space-between; margin-bottom: 10px;">
                                    <span>PPN (11%):</span>
                                    <span id="ppnDisplay" class="currency">Rp 0</span>
                                </div>
                                <div style="display: flex; justify-content: space-between; margin-bottom: 10px; font-weight: bold; font-size: 16px; border-top: 2px solid #ddd; padding-top: 10px;">
                                    <span>Grand Total:</span>
                                    <span id="grandTotalDisplay" class="currency">Rp 0</span>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="form-section">
                        <h3><i class="fas fa-sticky-note"></i> Keterangan & Informasi Tambahan</h3>
                        <div class="form-row">
                            <div class="form-group">
                                <label for="notes">Keterangan</label>
                                <textarea id="notes">PO URGENT - Segera diproses</textarea>
                            </div>
                            <div class="form-row" style="flex: 1; gap: 20px;">
                                <div class="form-group">
                                    <label for="entryBy">Entry Oleh</label>
                                    <input type="text" id="entryBy" value="ADAM">
                                </div>
                                <div class="form-group">
                                    <label for="approvedBy">Menyetujui</label>
                                    <input type="text" id="approvedBy" value="SOFYAN">
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="actions">
                        <button type="button" class="btn btn-primary" id="previewBtn">
                            <i class="fas fa-eye"></i> Preview PO
                        </button>
                        <button type="button" class="btn btn-warning" id="resetBtn">
                            <i class="fas fa-redo"></i> Reset Form
                        </button>
                        <button type="button" class="btn btn-success" id="saveBtn">
                            <i class="fas fa-save"></i> Simpan PO
                        </button>
                        <button type="button" class="btn btn-primary" onclick="saveDraft()">
                            <i class="fas fa-file-download"></i> Simpan Draft
                        </button>
                    </div>
                </div>
                
                <!-- Daftar PO Page -->
                <div class="page" id="daftar-po">
                    <div class="header">
                        <h2><i class="fas fa-list"></i> Daftar Purchase Order</h2>
                    </div>
                    
                    <div class="table-container">
                        <div class="table-header">
                            <div class="search-box">
                                <i class="fas fa-search"></i>
                                <input type="text" id="searchPO" placeholder="Cari berdasarkan No PO, Supplier, atau Status...">
                            </div>
                            <div class="filter-controls">
                                <select id="statusFilter" style="padding: 10px; border-radius: 10px; border: 2px solid #e1e1e1;">
                                    <option value="">Semua Status</option>
                                    <option value="draft">Draft</option>
                                    <option value="pending">Pending</option>
                                    <option value="approved">Disetujui</option>
                                    <option value="rejected">Ditolak</option>
                                </select>
                                <button class="btn btn-sm btn-warning" onclick="resetFilters()">
                                    <i class="fas fa-redo"></i> Reset
                                </button>
                            </div>
                        </div>
                        
                        <div class="table-responsive">
                            <table class="po-table" id="poListTable">
                                <thead>
                                    <tr>
                                        <th>No PO</th>
                                        <th>Supplier</th>
                                        <th>Tanggal</th>
                                        <th>Jumlah Item</th>
                                        <th>Total</th>
                                        <th>Status</th>
                                        <th>Aksi</th>
                                    </tr>
                                </thead>
                                <tbody>
                                </tbody>
                            </table>
                        </div>
                        
                        <div class="pagination">
                            <div class="page-size-selector">
                                <span>Show:</span>
                                <select id="pageSize" onchange="loadPOList()">
                                    <option value="5">5</option>
                                    <option value="10" selected>10</option>
                                    <option value="20">20</option>
                                    <option value="50">50</option>
                                    <option value="all">All</option>
                                </select>
                            </div>
                            
                            <div class="pagination-controls">
                                <button class="btn btn-sm" onclick="changePage(-1)">
                                    <i class="fas fa-chevron-left"></i> Previous
                                </button>
                                
                                <div class="page-numbers" id="pageNumbers">
                                </div>
                                
                                <button class="btn btn-sm" onclick="changePage(1)">
                                    Next <i class="fas fa-chevron-right"></i>
                                </button>
                            </div>
                            
                            <div class="page-info">
                                Showing <span id="startRow">1</span>-<span id="endRow">10</span> of <span id="totalRows">0</span> items
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Export Page -->
                <div class="page" id="export">
                    <div class="header">
                        <h2><i class="fas fa-file-export"></i> Export Data</h2>
                    </div>
                    
                    <div class="form-section">
                        <h3><i class="fas fa-download"></i> Export Options</h3>
                        <div class="form-row">
                            <div class="form-group">
                                <label for="exportFormat">Format Export</label>
                                <select id="exportFormat">
                                    <option value="csv">CSV (Excel)</option>
                                    <option value="json">JSON</option>
                                    <option value="pdf">PDF</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="dateFrom">Dari Tanggal</label>
                                <input type="date" id="dateFrom">
                            </div>
                            <div class="form-group">
                                <label for="dateTo">Sampai Tanggal</label>
                                <input type="date" id="dateTo">
                            </div>
                        </div>
                        
                        <div class="form-row">
                            <div class="form-group">
                                <label for="exportStatus">Status</label>
                                <select id="exportStatus" multiple style="height: 120px;">
                                    <option value="all" selected>Semua Status</option>
                                    <option value="draft">Draft</option>
                                    <option value="pending">Pending</option>
                                    <option value="approved">Disetujui</option>
                                    <option value="rejected">Ditolak</option>
                                </select>
                            </div>
                        </div>
                        
                        <div class="actions">
                            <button class="btn btn-success" onclick="exportData()">
                                <i class="fas fa-file-export"></i> Export Data
                            </button>
                            <button class="btn btn-primary" onclick="clearLocalStorage()">
                                <i class="fas fa-trash"></i> Clear All Data
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>
    
    <!-- Print Modal -->
    <div class="modal" id="printModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3><i class="fas fa-print"></i> Preview Purchase Order</h3>
                <button class="close-btn" onclick="closePrintModal()">&times;</button>
            </div>
            <div class="print-container" id="printContainer">
                <!-- Print content will be inserted here -->
            </div>
            <div class="modal-actions" style="padding: 20px; text-align: right;">
                <button class="btn btn-warning" onclick="closePrintModal()">
                    <i class="fas fa-times"></i> Tutup
                </button>
                <button class="btn btn-primary" onclick="printPO()">
                    <i class="fas fa-print"></i> Cetak
                </button>
            </div>
        </div>
    </div>
    
    <!-- Hidden div untuk print -->
    <div id="printSection" style="display: none;"></div>
    
    <!-- Notification -->
    <div class="notification" id="notification"></div>
    
    <script>
        // ==============================
        // MOBILE MENU IMPROVEMENTS
        // ==============================
        
        function setupMobileMenu() {
            const sidebar = document.getElementById('sidebar');
            const mobileMenuBtn = document.getElementById('mobileMenuBtn');
            const sidebarOverlay = document.getElementById('sidebarOverlay');
            const navLinks = document.querySelectorAll('.nav-link');
            
            function toggleSidebar() {
                sidebar.classList.toggle('active');
                sidebarOverlay.classList.toggle('active');
                mobileMenuBtn.classList.toggle('active');
                document.body.style.overflow = sidebar.classList.contains('active') ? 'hidden' : '';
                
                const icon = mobileMenuBtn.querySelector('i');
                if (sidebar.classList.contains('active')) {
                    icon.className = 'fas fa-times';
                } else {
                    icon.className = 'fas fa-bars';
                }
            }
            
            mobileMenuBtn.addEventListener('click', toggleSidebar);
            sidebarOverlay.addEventListener('click', toggleSidebar);
            
            navLinks.forEach(link => {
                link.addEventListener('click', () => {
                    if (window.innerWidth <= 992) {
                        toggleSidebar();
                    }
                });
            });
            
            document.addEventListener('click', (e) => {
                if (window.innerWidth <= 992 && 
                    sidebar.classList.contains('active') &&
                    !sidebar.contains(e.target) &&
                    e.target !== mobileMenuBtn &&
                    !mobileMenuBtn.contains(e.target)) {
                    toggleSidebar();
                }
            });
            
            document.addEventListener('keydown', (e) => {
                if (e.key === 'Escape' && sidebar.classList.contains('active')) {
                    toggleSidebar();
                }
            });
            
            updateMobileDate();
            
            window.addEventListener('resize', function() {
                if (window.innerWidth > 992) {
                    sidebar.classList.remove('active');
                    sidebarOverlay.classList.remove('active');
                    mobileMenuBtn.classList.remove('active');
                    const icon = mobileMenuBtn.querySelector('i');
                    icon.className = 'fas fa-bars';
                    document.body.style.overflow = '';
                }
            });
        }
        
        function updateMobileDate() {
            const mobileDate = document.getElementById('mobileDate');
            const currentDate = new Date().toLocaleDateString('id-ID', {
                day: 'numeric',
                month: 'short',
                year: 'numeric'
            });
            if (mobileDate) {
                mobileDate.textContent = currentDate;
            }
            
            const currentDateElement = document.getElementById('currentDate');
            if (currentDateElement) {
                currentDateElement.textContent = currentDate;
            }
        }
        
        function updateMobileHeader(pageId) {
            const mobileHeader = document.getElementById('mobileHeader');
            const pageTitles = {
                'dashboard': 'Dashboard',
                'buat-po': 'Buat PO Baru',
                'daftar-po': 'Daftar PO',
                'export': 'Export Data'
            };
            
            if (mobileHeader) {
                const title = pageTitles[pageId] || 'PO System';
                mobileHeader.querySelector('h2').innerHTML = `<i class="fas fa-file-invoice-dollar"></i> ${title}`;
            }
        }
        
        // ==============================
        // NAVIGATION
        // ==============================
        function setupNavigation() {
            const navLinks = document.querySelectorAll('.nav-link');
            navLinks.forEach(link => {
                link.addEventListener('click', (e) => {
                    e.preventDefault();
                    const pageId = link.getAttribute('data-page');
                    showPage(pageId);
                    
                    navLinks.forEach(l => l.classList.remove('active'));
                    link.classList.add('active');
                    
                    updateMobileHeader(pageId);
                });
            });
            
            showPage('dashboard');
            updateMobileHeader('dashboard');
        }
        
        function showPage(pageId) {
            document.querySelectorAll('.page').forEach(page => {
                page.classList.remove('active');
            });
            
            const activePage = document.getElementById(pageId);
            if (activePage) {
                activePage.classList.add('active');
            }
            
            updateMobileHeader(pageId);
            
            if (pageId === 'dashboard') {
                updateDashboard();
            } else if (pageId === 'daftar-po') {
                loadPOList();
            } else if (pageId === 'buat-po') {
                updateTotals();
            }
        }
        
        // ==============================
        // DATA MANAGEMENT
        // ==============================
        
        let poData = [];
        let currentPage = 1;
        let pageSize = 10;
        let totalPages = 1;
        let currentEditId = null;
        let poCounter = 1;
        let itemCount = 0;
        
        function initData() {
            const savedData = localStorage.getItem('poData');
            if (savedData) {
                poData = JSON.parse(savedData);
                // Cari nomor PO terakhir untuk counter
                if (poData.length > 0) {
                    const lastPO = poData[poData.length - 1];
                    if (lastPO.poNumber) {
                        const parts = lastPO.poNumber.split('.');
                        if (parts.length === 3) {
                            const lastNum = parseInt(parts[2]) || 0;
                            poCounter = lastNum + 1;
                        }
                    }
                }
            }
            
            const today = new Date().toISOString().split('T')[0];
            document.getElementById('poDate').value = today;
            
            generatePONumber();
            
            addItemRow();
            
            updateDashboard();
            updateTotals();
            updateMobileDate();
        }
        
        function updateDashboard() {
            const totalPO = poData.length;
            const pendingPO = poData.filter(po => po.status === 'pending').length;
            const approvedPO = poData.filter(po => po.status === 'approved').length;
            const totalAmount = poData.reduce((sum, po) => sum + (po.grandTotal || 0), 0);
            
            document.getElementById('totalPO').textContent = totalPO;
            document.getElementById('pendingPO').textContent = pendingPO;
            document.getElementById('approvedPO').textContent = approvedPO;
            document.getElementById('totalAmount').textContent = formatCurrencyDisplay(totalAmount);
            
            loadRecentPOs();
        }
        
        function loadRecentPOs() {
            const tbody = document.querySelector('#recentPOs tbody');
            if (!tbody) return;
            
            tbody.innerHTML = '';
            
            const recentPOs = [...poData]
                .sort((a, b) => new Date(b.date) - new Date(a.date))
                .slice(0, 5);
            
            recentPOs.forEach(po => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${po.poNumber || '-'}</td>
                    <td>${po.supplierName || '-'}</td>
                    <td>${formatDate(po.date)}</td>
                    <td class="currency-cell">${formatCurrencyDisplay(po.grandTotal || 0)}</td>
                    <td><span class="status-badge status-${po.status}">${getStatusText(po.status)}</span></td>
                    <td>
                        <div class="action-buttons">
                            <button class="btn btn-sm btn-primary" onclick="viewPO('${po.id}')">
                                <i class="fas fa-eye"></i>
                            </button>
                            <button class="btn btn-sm btn-warning" onclick="editPO('${po.id}')">
                                <i class="fas fa-edit"></i>
                            </button>
                        </div>
                    </td>
                `;
                tbody.appendChild(row);
            });
        }
        
        // ==============================
        // PO FORM FUNCTIONS
        // ==============================
        
        function generatePONumber() {
            const now = new Date();
            const year = now.getFullYear().toString().slice(-2);
            const month = (now.getMonth() + 1).toString().padStart(2, '0');
            const day = now.getDate().toString().padStart(2, '0');
            
            const counter = poCounter.toString().padStart(3, '0');
            const poNumber = `GM11.${year}${month}${day}.${counter}`;
            document.getElementById('poNumber').value = poNumber;
        }
        
        function addItemRow(item = null) {
            const tbody = document.getElementById('itemsBody');
            itemCount++;
            
            const row = document.createElement('tr');
            row.innerHTML = `
                <td>${itemCount}</td>
                <td><input type="text" class="item-name" value="${item ? item.name : ''}" placeholder="Nama barang" onchange="calculateRow(this)"></td>
                <td><input type="number" class="item-qty" value="${item ? item.qty : 1}" min="1" step="1" onchange="calculateRow(this)"></td>
                <td>
                    <select class="item-unit" onchange="calculateRow(this)">
                        <option value="PCS" ${(item && item.unit === 'PCS') ? 'selected' : ''}>PCS</option>
                        <option value="DUS" ${(item && item.unit === 'DUS') ? 'selected' : ''}>DUS</option>
                        <option value="SET" ${(item && item.unit === 'SET') ? 'selected' : ''}>SET</option>
                        <option value="PAK" ${(item && item.unit === 'PAK') ? 'selected' : ''}>PAK</option>
                        <option value="LSN" ${(item && item.unit === 'LSN') ? 'selected' : ''}>LSN</option>
                        <option value="RIM" ${(item && item.unit === 'RIM') ? 'selected' : ''}>RIM</option>
                        <option value="UNIT" ${(item && item.unit === 'UNIT') ? 'selected' : ''}>UNIT</option>
                    </select>
                </td>
                <td><input type="text" class="item-price" value="${item ? formatCurrencyInput(item.price) : '0'}" onchange="calculateRow(this)" onfocus="this.select()"></td>
                <td><input type="number" class="item-discount" value="${item ? item.discount : 0}" min="0" max="100" step="0.01" onchange="calculateRow(this)"></td>
                <td class="item-discount-total currency-cell">${item ? formatCurrencyDisplay(item.discountTotal || 0) : '0'}</td>
                <td class="item-total currency-cell">${item ? formatCurrencyDisplay(item.total || 0) : '0'}</td>
                <td>
                    <button class="btn btn-sm btn-danger" onclick="removeItemRow(this)">
                        <i class="fas fa-trash"></i>
                    </button>
                </td>
            `;
            
            tbody.appendChild(row);
            calculateRow(row);
            updateTotals();
        }
        
        function calculateRow(element) {
            const row = element.closest('tr');
            const qty = parseFloat(row.querySelector('.item-qty').value) || 0;
            const price = parseCurrency(row.querySelector('.item-price').value) || 0;
            const discount = parseFloat(row.querySelector('.item-discount').value) || 0;
            
            const subtotal = qty * price;
            const discountAmount = (subtotal * discount) / 100;
            const total = subtotal - discountAmount;
            
            row.querySelector('.item-discount-total').textContent = formatCurrencyDisplay(discountAmount);
            row.querySelector('.item-total').textContent = formatCurrencyDisplay(total);
            
            updateTotals();
        }
        
        function updateTotals() {
            let subTotal = 0;
            let totalDiscount = 0;
            
            const rows = document.querySelectorAll('#itemsBody tr');
            rows.forEach(row => {
                const total = parseCurrency(row.querySelector('.item-total').textContent) || 0;
                const discount = parseCurrency(row.querySelector('.item-discount-total').textContent) || 0;
                
                subTotal += total + discount;
                totalDiscount += discount;
            });
            
            const ppn = subTotal * 0.11;
            const grandTotal = subTotal + ppn;
            
            document.getElementById('subTotalDisplay').textContent = formatCurrencyDisplay(subTotal);
            document.getElementById('totalDiscountDisplay').textContent = formatCurrencyDisplay(totalDiscount);
            document.getElementById('ppnDisplay').textContent = formatCurrencyDisplay(ppn);
            document.getElementById('grandTotalDisplay').textContent = formatCurrencyDisplay(grandTotal);
        }
        
        function removeItemRow(button) {
            const row = button.closest('tr');
            row.remove();
            itemCount--;
            updateItemNumbers();
            updateTotals();
        }
        
        function clearAllItems() {
            if (confirm('Apakah Anda yakin ingin menghapus semua barang?')) {
                document.getElementById('itemsBody').innerHTML = '';
                itemCount = 0;
                updateTotals();
            }
        }
        
        function updateItemNumbers() {
            const rows = document.querySelectorAll('#itemsBody tr');
            rows.forEach((row, index) => {
                row.querySelector('td:first-child').textContent = index + 1;
            });
            itemCount = rows.length;
        }
        
        // ==============================
        // SAVE & RESET FUNCTIONS
        // ==============================
        
        function savePO() {
            // Collect form data
            const po = {
                id: Date.now().toString(),
                poNumber: document.getElementById('poNumber').value,
                date: document.getElementById('poDate').value,
                status: document.getElementById('poStatus').value,
                companyName: document.getElementById('companyName').value,
                companyAddress: document.getElementById('companyAddress').value,
                supplierName: document.getElementById('supplierName').value,
                supplierAddress: document.getElementById('supplierAddress').value,
                supplierPhone: document.getElementById('supplierPhone').value,
                notes: document.getElementById('notes').value,
                entryBy: document.getElementById('entryBy').value,
                approvedBy: document.getElementById('approvedBy').value,
                items: [],
                subTotal: 0,
                totalDiscount: 0,
                ppn: 0,
                grandTotal: 0,
                createdAt: new Date().toISOString()
            };
            
            // Collect items
            const rows = document.querySelectorAll('#itemsBody tr');
            rows.forEach(row => {
                const item = {
                    name: row.querySelector('.item-name').value,
                    qty: parseFloat(row.querySelector('.item-qty').value) || 0,
                    unit: row.querySelector('.item-unit').value,
                    price: parseCurrency(row.querySelector('.item-price').value) || 0,
                    discount: parseFloat(row.querySelector('.item-discount').value) || 0,
                    discountTotal: parseCurrency(row.querySelector('.item-discount-total').textContent) || 0,
                    total: parseCurrency(row.querySelector('.item-total').textContent) || 0
                };
                po.items.push(item);
                po.subTotal += item.total + item.discountTotal;
                po.totalDiscount += item.discountTotal;
            });
            
            po.ppn = po.subTotal * 0.11;
            po.grandTotal = po.subTotal + po.ppn;
            
            // Add to data array
            if (currentEditId) {
                const index = poData.findIndex(p => p.id === currentEditId);
                if (index !== -1) {
                    poData[index] = po;
                }
                currentEditId = null;
            } else {
                poData.push(po);
                poCounter++;
            }
            
            localStorage.setItem('poData', JSON.stringify(poData));
            
            showNotification('PO berhasil disimpan!', 'success');
            
            resetForm();
            
            updateDashboard();
            
            showPage('dashboard');
        }
        
        function saveDraft() {
            document.getElementById('poStatus').value = 'draft';
            savePO();
        }
        
        function resetForm() {
            if (confirm('Apakah Anda yakin ingin mereset form? Semua data yang belum disimpan akan hilang.')) {
                document.getElementById('companyName').value = 'PT. GRAND MITRA BANGUNAN';
                document.getElementById('companyAddress').value = 'THAMRIN CENTRE AVENUE NO. 18, JALAN MH THAMRIN KEL. KOSAMBI BARUT, KEC. KOSAMBI TANGERANG - BANTEN, TELP 021-39727272';
                document.getElementById('supplierName').value = '';
                document.getElementById('supplierAddress').value = '';
                document.getElementById('supplierPhone').value = '';
                document.getElementById('notes').value = 'PO URGENT - Segera diproses';
                document.getElementById('entryBy').value = 'ADAM';
                document.getElementById('approvedBy').value = 'SOFYAN';
                
                const today = new Date().toISOString().split('T')[0];
                document.getElementById('poDate').value = today;
                
                generatePONumber();
                
                document.getElementById('itemsBody').innerHTML = '';
                itemCount = 0;
                addItemRow();
                
                document.getElementById('poStatus').value = 'draft';
                currentEditId = null;
                
                updateTotals();
                
                showNotification('Form telah direset', 'success');
            }
        }
        
        // ==============================
        // PO LIST FUNCTIONS
        // ==============================
        
        function loadPOList() {
            const tbody = document.querySelector('#poListTable tbody');
            if (!tbody) return;
            
            tbody.innerHTML = '';
            
            const searchTerm = document.getElementById('searchPO').value.toLowerCase();
            const statusFilter = document.getElementById('statusFilter').value;
            
            let filteredData = poData.filter(po => {
                const matchesSearch = !searchTerm || 
                    (po.poNumber && po.poNumber.toLowerCase().includes(searchTerm)) ||
                    (po.supplierName && po.supplierName.toLowerCase().includes(searchTerm)) ||
                    po.status.includes(searchTerm);
                
                const matchesStatus = !statusFilter || po.status === statusFilter;
                
                return matchesSearch && matchesStatus;
            });
            
            const totalRows = filteredData.length;
            pageSize = parseInt(document.getElementById('pageSize').value) || 10;
            
            if (pageSize === 'all' || pageSize >= totalRows) {
                currentPage = 1;
                totalPages = 1;
            } else {
                totalPages = Math.ceil(totalRows / pageSize);
                currentPage = Math.min(currentPage, totalPages);
            }
            
            let currentData = filteredData;
            if (pageSize !== 'all' && totalRows > pageSize) {
                const start = (currentPage - 1) * pageSize;
                const end = start + pageSize;
                currentData = filteredData.slice(start, end);
            }
            
            currentData.forEach(po => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${po.poNumber || '-'}</td>
                    <td>${po.supplierName || '-'}</td>
                    <td>${formatDate(po.date)}</td>
                    <td>${po.items ? po.items.length : 0}</td>
                    <td class="currency-cell">${formatCurrencyDisplay(po.grandTotal || 0)}</td>
                    <td><span class="status-badge status-${po.status}">${getStatusText(po.status)}</span></td>
                    <td>
                        <div class="action-buttons">
                            <button class="btn btn-sm btn-primary" onclick="viewPO('${po.id}')">
                                <i class="fas fa-eye"></i>
                            </button>
                            <button class="btn btn-sm btn-warning" onclick="editPO('${po.id}')">
                                <i class="fas fa-edit"></i>
                            </button>
                            <button class="btn btn-sm btn-danger" onclick="deletePO('${po.id}')">
                                <i class="fas fa-trash"></i>
                            </button>
                        </div>
                    </td>
                `;
                tbody.appendChild(row);
            });
            
            updatePaginationControls(totalRows);
        }
        
        function updatePaginationControls(totalRows) {
            const startRow = pageSize === 'all' ? 1 : (currentPage - 1) * pageSize + 1;
            const endRow = pageSize === 'all' ? totalRows : Math.min(currentPage * pageSize, totalRows);
            
            document.getElementById('startRow').textContent = startRow;
            document.getElementById('endRow').textContent = endRow;
            document.getElementById('totalRows').textContent = totalRows;
            
            const pageNumbers = document.getElementById('pageNumbers');
            pageNumbers.innerHTML = '';
            
            if (pageSize !== 'all' && totalPages > 1) {
                for (let i = 1; i <= totalPages; i++) {
                    const pageBtn = document.createElement('button');
                    pageBtn.className = `page-btn ${i === currentPage ? 'active' : ''}`;
                    pageBtn.textContent = i;
                    pageBtn.onclick = () => {
                        currentPage = i;
                        loadPOList();
                    };
                    pageNumbers.appendChild(pageBtn);
                }
            }
        }
        
        function changePage(direction) {
            const newPage = currentPage + direction;
            if (newPage >= 1 && newPage <= totalPages) {
                currentPage = newPage;
                loadPOList();
            }
        }
        
        function resetFilters() {
            document.getElementById('searchPO').value = '';
            document.getElementById('statusFilter').value = '';
            currentPage = 1;
            loadPOList();
        }
        
        // ==============================
        // CRUD OPERATIONS
        // ==============================
        
        function viewPO(id) {
            const po = poData.find(p => p.id === id);
            if (!po) return;
            
            showPrintModal(po);
        }
        
        function editPO(id) {
            const po = poData.find(p => p.id === id);
            if (!po) return;
            
            document.getElementById('poNumber').value = po.poNumber;
            document.getElementById('poDate').value = po.date;
            document.getElementById('poStatus').value = po.status;
            document.getElementById('companyName').value = po.companyName;
            document.getElementById('companyAddress').value = po.companyAddress;
            document.getElementById('supplierName').value = po.supplierName;
            document.getElementById('supplierAddress').value = po.supplierAddress;
            document.getElementById('supplierPhone').value = po.supplierPhone;
            document.getElementById('notes').value = po.notes;
            document.getElementById('entryBy').value = po.entryBy;
            document.getElementById('approvedBy').value = po.approvedBy;
            
            document.getElementById('itemsBody').innerHTML = '';
            itemCount = 0;
            po.items.forEach(item => addItemRow(item));
            
            currentEditId = id;
            
            showPage('buat-po');
            
            showNotification('PO sedang diedit', 'warning');
        }
        
        function deletePO(id) {
            if (confirm('Apakah Anda yakin ingin menghapus PO ini?')) {
                poData = poData.filter(p => p.id !== id);
                localStorage.setItem('poData', JSON.stringify(poData));
                loadPOList();
                updateDashboard();
                showNotification('PO berhasil dihapus', 'success');
            }
        }
        
        // ==============================
        // PRINT FUNCTIONS - DIPERBAIKI untuk mobile
        // ==============================
        
        function showPrintModal(po = null) {
            if (!po) {
                po = {
                    poNumber: document.getElementById('poNumber').value || 'DRAFT',
                    date: document.getElementById('poDate').value || new Date().toISOString().split('T')[0],
                    companyName: document.getElementById('companyName').value,
                    companyAddress: document.getElementById('companyAddress').value,
                    supplierName: document.getElementById('supplierName').value,
                    supplierAddress: document.getElementById('supplierAddress').value,
                    supplierPhone: document.getElementById('supplierPhone').value,
                    notes: document.getElementById('notes').value,
                    entryBy: document.getElementById('entryBy').value,
                    approvedBy: document.getElementById('approvedBy').value,
                    items: [],
                    subTotal: 0,
                    totalDiscount: 0,
                    ppn: 0,
                    grandTotal: 0
                };
                
                const rows = document.querySelectorAll('#itemsBody tr');
                rows.forEach(row => {
                    const item = {
                        name: row.querySelector('.item-name').value,
                        qty: parseFloat(row.querySelector('.item-qty').value) || 0,
                        unit: row.querySelector('.item-unit').value,
                        price: parseCurrency(row.querySelector('.item-price').value) || 0,
                        discount: parseFloat(row.querySelector('.item-discount').value) || 0,
                        discountTotal: parseCurrency(row.querySelector('.item-discount-total').textContent) || 0,
                        total: parseCurrency(row.querySelector('.item-total').textContent) || 0
                    };
                    po.items.push(item);
                    po.subTotal += item.total + item.discountTotal;
                    po.totalDiscount += item.discountTotal;
                });
                
                po.ppn = po.subTotal * 0.11;
                po.grandTotal = po.subTotal + po.ppn;
            }
            
            const printContainer = document.getElementById('printContainer');
            
            // Format tanggal
            const dateObj = new Date(po.date);
            const formattedDate = dateObj.toLocaleDateString('id-ID', {
                day: '2-digit',
                month: '2-digit',
                year: 'numeric'
            });
            const currentDateTime = new Date().toLocaleString('id-ID', {
                day: '2-digit',
                month: '2-digit',
                year: 'numeric',
                hour: '2-digit',
                minute: '2-digit'
            });
            
            // Generate items table rows
            let itemsHtml = '';
            po.items.forEach((item, index) => {
                itemsHtml += `
                    <tr>
                        <td class="text-center">${index + 1}</td>
                        <td>${item.name || '-'}</td>
                        <td class="text-center">${item.qty} ${item.unit}</td>
                        <td class="text-right">${formatCurrencyPrint(item.price)}</td>
                        <td class="text-center">${item.discount}</td>
                        <td class="text-right">${formatCurrencyPrint(item.discountTotal)}</td>
                        <td class="text-right">${formatCurrencyPrint(item.total)}</td>
                    </tr>
                `;
            });
            
            // Generate print content sesuai gambar baru
            printContainer.innerHTML = `
                <div style="max-width: 800px; margin: 0 auto; background: white; color: black;">
                    <!-- Header Perusahaan sesuai gambar baru -->
                    <div style="text-align: center; margin-bottom: 15px;">
                        <h2 style="margin: 0; font-size: 16px; font-weight: bold; text-transform: uppercase;">${po.supplierName || 'ANGELS WINGS'}</h2>
                        <p style="margin: 2px 0; font-size: 12px; text-transform: uppercase;">${po.supplierAddress || 'PIK2'}</p>
                    </div>
                    
                    <!-- Judul PO -->
                    <div style="text-align: center; margin-bottom: 15px;">
                        <h1 style="margin: 0; font-size: 18px; font-weight: bold; text-transform: uppercase;">PURCHASE ORDER</h1>
                    </div>
                    
                    <!-- Info PO dan Supplier -->
                    <div style="display: flex; justify-content: space-between; margin-bottom: 15px; font-size: 11px;">
                        <div style="flex: 1;">
                            <p style="margin: 2px 0;"><strong>Kepada:</strong></p>
                            <p style="margin: 2px 0;">${po.companyName}</p>
                            <p style="margin: 2px 0;">${po.supplierAddress || 'PIK2'}</p>
                            <p style="margin: 2px 0;">Telp: ${po.supplierPhone || '021-12345678'}</p>
                        </div>
                        <div style="flex: 1; text-align: right;">
                            <p style="margin: 2px 0;"><strong>No. PO:</strong> ${po.poNumber}</p>
                            <p style="margin: 2px 0;"><strong>Tanggal:</strong> ${formattedDate}</p>
                        </div>
                    </div>
                    
                    <!-- Tabel Items -->
                    <table class="print-table">
                        <thead>
                            <tr>
                                <th width="5%">NO</th>
                                <th width="35%">NAMA BARANG</th>
                                <th width="10%">QTY</th>
                                <th width="12%">HARGA SAT</th>
                                <th width="8%">DISC %</th>
                                <th width="12%">DISC TOTAL</th>
                                <th width="12%">JUMLAH</th>
                            </tr>
                        </thead>
                        <tbody>
                            ${itemsHtml}
                        </tbody>
                    </table>
                    
                    <!-- Keterangan -->
                    <div style="margin: 10px 0; font-size: 11px;">
                        <p style="margin: 5px 0;"><strong>Keterangan :</strong> ${po.notes || 'PO URGENT - Segera diproses'}</p>
                    </div>
                    
                    <!-- Tabel Total -->
                    <table class="total-table">
                        <tr>
                            <td class="total-label">SUB TOTAL :</td>
                            <td class="total-value">${formatCurrencyPrint(po.subTotal)}</td>
                        </tr>
                        <tr>
                            <td class="total-label">DISC :</td>
                            <td class="total-value">${formatCurrencyPrint(po.totalDiscount)}</td>
                        </tr>
                        <tr>
                            <td class="total-label">JUMLAH :</td>
                            <td class="total-value">${formatCurrencyPrint(po.subTotal - po.totalDiscount)}</td>
                        </tr>
                        <tr>
                            <td class="total-label">PPN :</td>
                            <td class="total-value">${formatCurrencyPrint(po.ppn)}</td>
                        </tr>
                        <tr style="background-color: #f0f0f0;">
                            <td class="total-label"><strong>TOTAL :</strong></td>
                            <td class="total-value"><strong>${formatCurrencyPrint(po.grandTotal)}</strong></td>
                        </tr>
                    </table>
                    
                    <!-- Tanda Tangan -->
                    <div class="signature-section">
                        <div class="signature-box">
                            <div class="signature-line"></div>
                            <p style="margin: 5px 0; font-size: 11px; font-weight: bold;">( ${po.entryBy} )</p>
                            <p style="margin: 0; font-size: 11px;">Entry</p>
                        </div>
                        <div class="signature-box">
                            <div class="signature-line"></div>
                            <p style="margin: 5px 0; font-size: 11px; font-weight: bold;">( ${po.approvedBy} )</p>
                            <p style="margin: 0; font-size: 11px;">Menyetujui</p>
                        </div>
                    </div>
                    
                    <!-- Tanggal & Waktu -->
                    <div style="text-align: right; margin-top: 20px; font-size: 11px;">
                        <p style="margin: 0;">${currentDateTime}</p>
                        <p style="margin: 0;">Tanggal & Waktu</p>
                    </div>
                </div>
            `;
            
            document.getElementById('printModal').classList.add('active');
        }
        
        function closePrintModal() {
            document.getElementById('printModal').classList.remove('active');
        }
        
        // Fungsi print yang diperbaiki untuk mobile dan desktop
        function printPO() {
            // Simpan konten print ke hidden div
            const printContent = document.getElementById('printContainer').innerHTML;
            const printSection = document.getElementById('printSection');
            
            // Bersihkan dan set konten untuk print
            printSection.innerHTML = `
                <div style="padding: 20px; font-family: Arial, sans-serif; font-size: 12px; color: black; background: white;">
                    ${printContent}
                </div>
            `;
            
            // Tampilkan section print
            printSection.style.display = 'block';
            
            // Simpan konten asli body
            const originalBody = document.body.innerHTML;
            
            // Ganti body dengan konten print saja
            document.body.innerHTML = printSection.innerHTML;
            
            // Tambahkan style untuk print
            const style = document.createElement('style');
            style.innerHTML = `
                @media print {
                    body {
                        margin: 0;
                        padding: 20px;
                        background: white !important;
                        color: black !important;
                    }
                    * {
                        box-shadow: none !important;
                        text-shadow: none !important;
                    }
                    table, th, td {
                        border: 1px solid black !important;
                        background: white !important;
                        color: black !important;
                    }
                    th {
                        background-color: #f0f0f0 !important;
                    }
                    .no-print {
                        display: none !important;
                    }
                }
            `;
            document.head.appendChild(style);
            
            // Trigger print
            window.print();
            
            // Kembalikan ke konten asli
            document.body.innerHTML = originalBody;
            printSection.style.display = 'none';
            
            // Re-initialize setelah printing
            initData();
            closePrintModal();
        }
        
        // ==============================
        // UTILITY FUNCTIONS
        // ==============================
        
        // Format currency untuk input (tanpa Rp)
        function formatCurrencyInput(amount) {
            return amount.toLocaleString('id-ID', {
                minimumFractionDigits: 0,
                maximumFractionDigits: 0
            });
        }
        
        // Parse currency dari string input
        function parseCurrency(currencyString) {
            if (!currencyString) return 0;
            const cleaned = currencyString.toString()
                .replace(/[^0-9.,]/g, '')
                .replace(/\./g, '')
                .replace(',', '.');
            return parseFloat(cleaned) || 0;
        }
        
        // Format currency untuk display (dengan Rp dan titik)
        function formatCurrencyDisplay(amount) {
            return 'Rp ' + amount.toLocaleString('id-ID', {
                minimumFractionDigits: 0,
                maximumFractionDigits: 0
            });
        }
        
        // Format currency untuk cetakan (sesuai gambar)
        function formatCurrencyPrint(amount) {
            return amount.toLocaleString('id-ID', {
                minimumFractionDigits: 2,
                maximumFractionDigits: 2
            }).replace(/,/g, '.');
        }
        
        function formatDate(dateString) {
            if (!dateString) return '-';
            const date = new Date(dateString);
            return date.toLocaleDateString('id-ID', {
                day: 'numeric',
                month: 'short',
                year: 'numeric'
            });
        }
        
        function getStatusText(status) {
            const statusMap = {
                'draft': 'Draft',
                'pending': 'Pending',
                'approved': 'Disetujui',
                'rejected': 'Ditolak'
            };
            return statusMap[status] || status;
        }
        
        function showNotification(message, type = 'success') {
            const notification = document.getElementById('notification');
            notification.textContent = message;
            notification.className = `notification ${type}`;
            notification.classList.add('show');
            
            setTimeout(() => {
                notification.classList.remove('show');
            }, 3000);
        }
        
        // ==============================
        // EXPORT FUNCTIONS
        // ==============================
        
        function exportData() {
            const format = document.getElementById('exportFormat').value;
            const dateFrom = document.getElementById('dateFrom').value;
            const dateTo = document.getElementById('dateTo').value;
            
            let filteredData = poData;
            if (dateFrom) {
                filteredData = filteredData.filter(po => po.date >= dateFrom);
            }
            if (dateTo) {
                filteredData = filteredData.filter(po => po.date <= dateTo);
            }
            
            if (format === 'csv') {
                exportToCSV(filteredData);
            } else if (format === 'json') {
                exportToJSON(filteredData);
            } else {
                showNotification('Export PDF belum tersedia', 'warning');
            }
        }
        
        function exportToCSV(data) {
            let csv = 'No PO,Supplier,Tanggal,Jumlah Item,Total,Status\n';
            
            data.forEach(po => {
                csv += `"${po.poNumber}","${po.supplierName}","${formatDate(po.date)}","${po.items ? po.items.length : 0}","${formatCurrencyDisplay(po.grandTotal || 0)}","${getStatusText(po.status)}"\n`;
            });
            
            const blob = new Blob([csv], { type: 'text/csv' });
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `po_data_${new Date().toISOString().slice(0, 10)}.csv`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            
            showNotification('Data berhasil diexport ke CSV', 'success');
        }
        
        function exportToJSON(data) {
            const json = JSON.stringify(data, null, 2);
            const blob = new Blob([json], { type: 'application/json' });
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `po_data_${new Date().toISOString().slice(0, 10)}.json`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            
            showNotification('Data berhasil diexport ke JSON', 'success');
        }
        
        function clearLocalStorage() {
            if (confirm('Apakah Anda yakin ingin menghapus semua data? Tindakan ini tidak dapat dibatalkan.')) {
                localStorage.removeItem('poData');
                poData = [];
                updateDashboard();
                loadPOList();
                showNotification('Semua data telah dihapus', 'success');
            }
        }
        
        // ==============================
        // INITIALIZATION
        // ==============================
        
        document.addEventListener('DOMContentLoaded', function() {
            setupMobileMenu();
            setupNavigation();
            initData();
            
            document.getElementById('addItemBtn').addEventListener('click', () => addItemRow());
            document.getElementById('clearItemsBtn').addEventListener('click', clearAllItems);
            document.getElementById('previewBtn').addEventListener('click', () => showPrintModal());
            document.getElementById('resetBtn').addEventListener('click', resetForm);
            document.getElementById('saveBtn').addEventListener('click', savePO);
            
            document.getElementById('searchPO').addEventListener('input', loadPOList);
            document.getElementById('statusFilter').addEventListener('change', loadPOList);
            
            document.getElementById('printModal').addEventListener('click', function(e) {
                if (e.target === this) closePrintModal();
            });
            
            document.addEventListener('keydown', function(e) {
                if (e.key === 'Escape') closePrintModal();
            });
            
            // Auto calculate ketika input berubah
            document.addEventListener('input', function(e) {
                if (e.target.classList.contains('item-price') || 
                    e.target.classList.contains('item-qty') || 
                    e.target.classList.contains('item-discount')) {
                    calculateRow(e.target);
                }
            });
        });
    </script>
</body>
</html>
